name: 'Solana test-bpf'
author: 'MRGN Labs'
description: 'Run solana rust tests'
branding:
  icon: aperture
  color: purple
inputs:
  args:
    description: 'cargo test-bpf arguments'
    required: false
    default: ''
  thread_stack_size:
    description: 'size of stack for spawned threads'
    required: false
    default: '8192000' # 4Mb
runs:
  using: 'docker'
  image: 'docker://mrgnlabs/solana-dev:0.0.2-alpha'
  entrypoint: shell-exec
  args: 
    - 'RUST_MIN_STACK=${{ inputs.thread_stack_size }} cargo test-bpf ${{ inputs.args }}'
